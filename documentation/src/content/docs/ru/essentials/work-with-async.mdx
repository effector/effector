---
title: –≠—Ñ—Ñ–µ–∫—Ç—ã –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
description: –ö–∞–∫ —ç—Ñ—Ñ–µ–∫—Ç—ã –ø–æ–º–æ–≥–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å—é –≤ effector
lang: ru
---

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –≤ effector —Å –ø–æ–º–æ—â—å—é —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (#async-operation-with-effects)

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ –±–∞–∑–æ–≤–∞—è —á–∞—Å—Ç—å –ª—é–±–æ–≥–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏ Effector –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –µ—ë –æ–±—Ä–∞–±–æ—Ç–∫–∏. –° –ø–æ–º–æ—â—å—é —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ ([createEffect](/ru/api/effector/createEffect)) –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—É—é –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

:::tip{title="–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤"}
–ö–æ–º–∞–Ω–¥–∞ Effector —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Fx` –ø–æ—Å—Ç—Ñ–∏–∫—Å –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, —ç—Ç–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ–º, –∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.
:::

## –ß—Ç–æ —Ç–∞–∫–æ–µ —ç—Ñ—Ñ–µ–∫—Ç—ã? (#what-are-effects)

–≠—Ñ—Ñ–µ–∫—Ç—ã ([Effect](/ru/api/effector/Effect)) ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Effector –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ api, –∏–ª–∏ –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä:

- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –†–∞–±–æ—Ç–∞ —Å `localStorage`/`indexedDB`
- –õ—é–±—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ª–∏–±–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è –ª–∏–±–æ –≤—ã–∫–∏–Ω—É—Ç—å –æ—à–∏–±–∫—É, –∏–ª–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∫–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è

:::tip{title="–ø–æ–ª–µ–∑–Ω–æ –∑–Ω–∞—Ç—å"}
–≠—Ñ—Ñ–µ–∫—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π, —Ç–∞–∫ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π.
:::

## –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (#main-effect-states)

–†–∞–±–æ—Ç–∞—Ç—å —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏—è–º –∏ —Å–æ–±—ã—Ç–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞:

- `pending` ‚Äî —è–≤–ª—è–µ—Ç—Å—è [—Å—Ç–æ—Ä–æ–º](/ru/api/effector/Store) —É–∫–∞–∑—ã–≤–∞–µ—Ç, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏ —ç—Ñ—Ñ–µ–∫—Ç, –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏.
- `done` ‚Äî —è–≤–ª—è–µ—Ç—Å—è [—Å–æ–±—ã—Ç–∏–µ–º](/ru/api/effector/Event), —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏.
- `fail` ‚Äî —è–≤–ª—è–µ—Ç—Å—è [—Å–æ–±—ã—Ç–∏–µ–º](/ru/api/effector/Event), —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ.
- `finally` ‚Äî —è–≤–ª—è–µ—Ç—Å—è [—Å–æ–±—ã—Ç–∏–µ–º](/ru/api/effector/Event), —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–≥–¥–∞ —ç—Ñ—Ñ–µ–∫—Ç –∑–∞–≤–µ—Ä–µ—à–µ–Ω —Å –æ—à–∏–±–∫–æ–π –∏–ª–∏ —É—Å–ø–µ—à–Ω–æ.

–° –ø–æ–ª–Ω—ã–º api `effect` –º–æ–∂–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è [–∑–¥–µ—Å—å](/ru/api/effector/Effect).

:::warning{title="–í–∞–∂–Ω–∞—è –∑–∞–º–µ—Ç–∫–∞"}
–ù–µ —Å—Ç–æ–∏—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –≤ —Ä—É—á–Ω—É—é, effector —Å–∞–º —Å–¥–µ–ª–∞–µ—Ç —ç—Ç–æ.
:::

```ts
const fetchUserFx = createEffect(() => {
  /* –≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ api */
});

fetchUserFx.pending.watch((isPending) => console.log("Pending:", isPending));

fetchUserFx.done.watch(({ params, result }) => console.log(`Fetched user ${params}:`, result));

fetchUserFx.finally.watch((value) => {
  if (value.status === "done") {
    console.log("fetchUserFx resolved ", value.result);
  } else {
    console.log("fetchUserFx rejected ", value.error);
  }
});

fetchUserFx.fail.watch(({ params, error }) =>
  console.error(`Failed to fetch user ${params}:`, error),
);

fetchUserFx();
```

## –ü—Ä–∏–≤—è–∑–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∫ —Å–æ–±—ã—Ç–∏—è–º –∏ —Å—Ç–æ—Ä–∞–º (#binding-effects-to-events-and-stores)

### –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å—Ç–æ—Ä –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞ (#update-store-when-effect-completes)

–î–æ–ø—É—Å—Ç–∏–º –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã —ç—Ñ—Ñ–µ–∫—Ç–∞ effector –≤–∑—è–ª –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤–µ—Ä–Ω—É–ª —ç—Ñ—Ñ–µ–∫—Ç, –∏ –æ–±–Ω–æ–≤–∏–ª —Å—Ç–æ—Ä —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–æ–±—ã—Ç–∏–π —ç—Ñ—Ñ–µ–∫—Ç–∞:

```ts
import { createStore, createEffect } from "effector";

const fetchUserNameFx = createEffect(async (userId: string) => {
  const userData = await fetch(`/api/users/${userId}`);

  return userData.name;
});

const $error = createStore<string | null>(null);
const $userName = createStore("");
const $isLoading = fetchUserNameFx.pending.map((isPending) => isPending);

$error.reset(fetchUserNameFx.done);

$userName.on(fetchUserNameFx.done, (_, { params, result }) => result);
$error.on(fetchUserNameFx.fail, (_, { params, error }) => error.message);
// –∏–ª–∏ üîÉ
$userName.on(fetchUserNameFx.doneData, (_, result) => result);
$error.on(fetchUserNameFx.failData, (_, error) => error.message);

$isLoading.watch((loading) => console.log("Is loading:", loading));
```

`doneData` –∏ `failData` —è–≤–ª—è—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã `done` –∏ `fail` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ –æ–Ω–∏ –ø–æ–ª—É—á–∞—é—Ç —Ç–æ–ª—å–∫–æ `result` –∏ `error` –≤ —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

### –í—ã–∑–æ–≤ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è (#triggering-effect-on-events)

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ –≤—ã–∑–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –∫–∞–∫–æ–≥–æ-–Ω–∏–±—É–¥—å —Å–æ–±—ã—Ç–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã, –∏–ª–∏ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É, –≤ —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –≤–∞–º –ø–æ–º–æ–∂–µ—Ç –º–µ—Ç–æ–¥ `sample`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑–æ–≤–µ—Ç `target`, –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ `clock`.

:::info{title="–§—É–Ω–∫—Ü–∏—è sample"}
–§—É–Ω–∫—Ü–∏—è `sample` —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è —é–Ω–∏—Ç–æ–≤. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –≥–∏–±–∫–æ –∏ –ª–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∞–∫—Ç–∏–≤–Ω—É—é –ª–æ–≥–∏–∫—É –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
:::

```ts
import { createEvent, sample } from "effector";

const userLoginFx = createEffect(() => {
  // –∫–∞–∫–∞—è-—Ç–æ –ª–æ–≥–∏–∫–∞
});

// –°–æ–±—ã—Ç–∏–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
const formSubmitted = createEvent();

// –°–≤—è–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º
sample({
  clock: formSubmitted, // –ö–æ–≥–¥–∞ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
  target: userLoginFx, // –ó–∞–ø—É—Å—Ç–∏ —ç—Ç–æ
});

// –≥–¥–µ-—Ç–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
formSubmitted();
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ —ç—Ñ—Ñ–µ–∫—Ç–∞—Ö (#error-handing-in-effects)

Effector –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–¥–µ–∂–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫. –ö–æ–≥–¥–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞, –æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏–µ `fail`.

–ß—Ç–æ–±—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É –≤ —ç—Ñ—Ñ–µ–∫—Ç–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ç–∏–ø –≤ generic —Ç—Ä–µ—Ç—å–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º —Ñ—É–Ω–∫—Ü–∏–∏ `createEffect`:

```ts
import { createEffect } from "effector";

class CustomError extends Error {
  // —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}

const effect = createEffect<Params, ReturnValue, CustomError>(async () => {
  const response = await fetch(`/api/users/${userId}`);

  if (!response.ok) {
    // –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º .fail
    throw new CustomError(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${response.statusText}`);
  }

  return response.json();
});
```

–ï—Å–ª–∏ –≤—ã –≤—ã–±—Ä–æ—Å–∏—Ç–µ –æ—à–∏–±–∫—É –¥—Ä—É–≥–æ–≥–æ —Ç–∏–ø–∞, TypeScript –ø–æ–∫–∞–∂–µ—Ç –≤–∞–º –æ—à–∏–±–∫—É.

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä (#effects-practical-example)

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç ID, –∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é –∫–Ω–æ–ø–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ –Ω—ë–º.

```ts
import { createStore, createEvent, createEffect, sample } from "effector";

// –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
const fetchUserFx = createEffect(async (id: number) => {
  const response = await fetch(`/api/user/${id}`);

  if (!response.ok) {
    // –º–æ–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É, –ø—Ä–µ–∂–¥–µ —á–µ–º –æ–Ω–∞ –ø–æ–ø–∞–¥–µ—Ç –≤ fail/failData
    throw new Error("User not found");
  }

  return response.json();
});

const setId = createEvent<number>();
const submit = createEvent();

const $id = createStore(0);
const $user = createStore<{ name: string } | null>(null);
const $error = createStore<string | null>(null);
const $isLoading = fetchUserFx.pending;

$id.on(setId, (_, id) => id);
$user.on(fetchUserFx.doneData, (_, user) => user);
$error.on(fetchUserFx.fail, (_, { error }) => error.message);
$error.reset(fetchUserFx.done);

// –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: –∑–∞–ø—É—Å–∫–∞–µ–º fetchUserFx –ø—Ä–∏ submit
sample({
  clock: submit,
  source: $id,
  target: fetchUserFx,
});

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
setId(1); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º ID
submit(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
```

[–û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø–æ–ª–Ω—ã–º API –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤](/ru/api/effector/Effect)
