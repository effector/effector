---
import IconChevron from "@icons/Chevron.astro";
import Hero from "@components/Landing/Hero.astro";
import FeaturesGrid from "@components/Landing/FeaturesGrid.astro";
import Feature from "@components/Landing/Feature.astro";
import Stats from "@components/Landing/Stats.astro";
import Companies from "@components/Landing/Companies.astro";
import DropDownMenu from "@components/DropDownMenu.astro";

import Landing from "../layouts/Landing.astro";
import { SITE } from "../consts";
import { DESKTOP_NAVIGATION } from "../navigation";
import { getPathParamsFromId, getTextLocalized } from "../languages";

const features = [
  {
    emoji: "â˜„ï¸",
    kind: "major",
    title: "Effector Atlas",
    description:
      "Experience the power of effector v23.4, featuring refined typings, universal hooks support.",
  },
  {
    emoji: "ðŸ›¡ï¸",
    title: "Type safe",
    description:
      "Excellent TypeScript support out of the box. With the type testing in the repository.",
  },
  {
    emoji: "âš™ï¸",
    title: "Framework agnostic",
    description: "Works with any UI or server framework. Tested with React, Solid, Vue.",
  },
  {
    emoji: "âš¡ï¸",
    title: "Performant",
    description:
      "Initialization of the whole logic at the app start provides a boost at the runtime.",
  },
  {
    emoji: "ðŸ“¦",
    title: "10Kb",
    description:
      "Effector supports tree-shaking and provides maximum opportunities with the small size.",
  },
  {
    emoji: "ðŸ«‚",
    title: "Just JavaScript",
    description:
      "There is no Proxies, classes and some magic inside. Just JavaScript code that works.",
  },
  {
    emoji: "ðŸ§‘â€ðŸ’»",
    kind: "minor",
    title: "Developer-friendly",
    description:
      "Simple API surface with helpful community. Easy to write tests. Easy to setup server rendering.",
  },
] as { emoji: string; kind?: "minor" | "major"; title: string; description: string }[];

const { lang } = getPathParamsFromId(Astro.url.pathname);
const apiNavigation = DESKTOP_NAVIGATION.find((item) => item.text.en === "API");
const apiLinks = apiNavigation && "items" in apiNavigation ? apiNavigation.items ?? [] : [];
const apiMenuLinks =
  apiLinks.length > 0
    ? apiLinks
    : [
        {
          text: { en: "API", ru: "API", uz: "API" },
          link: "/api",
        },
      ];
const apiLabel = apiNavigation ? getTextLocalized(apiNavigation, lang) : "API";
---

<Landing title="Welcome" lang={lang} dir="ltr" description={SITE.description}>
  <Hero subtitle="Write business logic with ease">
    Meet the new standard for modern TypeScript development.
    <br />
    Type safe, reactive, framework agnostic.

    <div slot="links" class="started-links">
      <a class="primary" href={`/${lang}/introduction/get-started`}>
      <span>Getting started</span>
      <IconChevron />
    </a>
    <span>or check the api</span>
          <DropDownMenu class="api-dropdown" links={apiMenuLinks}>
        <span>{apiLabel}</span>
      </DropDownMenu>
    </div>

  </Hero>
  <FeaturesGrid>
    {
      features.map((feat) => (
        <Feature title={feat.title} emoji={feat.emoji} kind={feat.kind}>
          {feat.description}
        </Feature>
      ))
    }
  </FeaturesGrid>
  <!-- <Stats /> -->
  <Companies />
</Landing>

<style>
  .started-links{
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-2);
  }

  :global(.hero .links) {
    gap: var(--space-3);
    flex-wrap: wrap;
    align-items: center;
  }

  :global(.api-dropdown .menu-button) {
    border-radius: 9999px;
    padding: 0.4rem 0.75rem;
    background: var(--theme-bg-sidebar-main-tabs);
    border: 1px solid var(--theme-sidebar-surface-border, var(--theme-sidebar-border));
    box-shadow: var(--theme-sidebar-tab-shadow, var(--shadow-sm));
  }

  :global(.api-dropdown .menu-button:hover) {
    background: var(--theme-bg-sidebar-main-tabs-active);
  }

  :global(.api-dropdown .button-title) {
    display: flex;
    align-items: center;
    gap: 0.35rem;
  }
</style>
